<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Redis-基础, 戚中一">
    <meta name="description" content="写在前面：本文主要记录 Redis使用基础 的相关基础知识


1. 介绍Redis：Remote Dictionary Server，远程字典服务；是一个开源的使用C语言编写、支持网络、可基于内存亦可持久化的数据结构存储系统，可用作 Ke">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Redis-基础 | 戚中一</title>
    <link rel="icon" type="image/jpeg" href="/logo.jpg">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.2"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/logo.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">戚中一</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/logo.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">戚中一</div>
        <div class="logo-desc">
            
            戚中一
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="ttps://github.com/qizhongyizhang" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="ttps://github.com/qizhongyizhang" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Redis-基础</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">
                                <span class="chip bg-color">数据库</span>
                            </a>
                        
                            <a href="/tags/NoSQL/">
                                <span class="chip bg-color">NoSQL</span>
                            </a>
                        
                            <a href="/tags/Redis/">
                                <span class="chip bg-color">Redis</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%9F%BA%E7%A1%80/" class="post-category">
                                基础
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-05-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2022-10-20
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    19 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>写在前面：本文主要记录 Redis使用基础 的相关基础知识</p>
<span id="more"></span>

<h1 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h1><p><strong>Redis</strong>：Remote Dictionary Server，远程字典服务；是一个开源的使用C语言编写、支持网络、可基于内存亦可持久化的数据结构存储系统，可用作 <strong>Key-Value数据库、缓存和消息中间件MQ</strong>；与 Memcached 类似，支持存储多种数据类型，包括 string ：字符串、list：链表、set：集合、zset：sorted set，有序集合 和 hash：哈希类型等；<strong>数据缓存在内存中</strong>，周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件进行持久化；支持高速缓存服务，由 <strong>单线程+多路I/O复用</strong>：Tornado-支持万级并发、Node.js实现，<a target="_blank" rel="noopener" href="https://redis.io/"><font face = "微软雅黑" color = 1E90FF size = 5>英文官网</font></a>，<a target="_blank" rel="noopener" href="http://redis.cn/"><font face = "微软雅黑" color = 1E90FF size = 5>中文官网</font></a></p>
<p><strong>应用场景</strong>：</p>
<ul>
<li>高速缓存服务：将用户经常访问的数据（热数据）从数据库搬到内存</li>
<li>实时排行榜</li>
<li>高时效数据，如手机验证码</li>
<li>发布订阅消息系统</li>
</ul>
<p><strong>数据保存方式</strong>：</p>
<ul>
<li>rdb：保存数据，redis-check-rdb –fix dump.rdb</li>
<li>aof：记录执行的命令，redis-check-aof –fix appendonly.aof</li>
</ul>
<h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2. 安装"></a>2. 安装</h1><h2 id="2-1-Linux安装"><a href="#2-1-Linux安装" class="headerlink" title="2.1 Linux安装"></a>2.1 Linux安装</h2><p>官方建议在 Linux 部署服务，本文仅介绍 Linux 安装</p>
<ol>
<li>访问 <a target="_blank" rel="noopener" href="https://redis.io/"><font face = "微软雅黑" color = 1E90FF size = 5>官网</font></a> 进行下载，如下图，点击后选择合适的版本；推荐下载稳定版<br> <img src="https://qizhongyi.gitee.io/images/Data/DataBase/Redis/Redis_Download.png" alt="Redis_Download">   可按如下图查看安装操作指引： <img src="https://qizhongyi.gitee.io/images/Data/DataBase/Redis/Redis_Install_Guide.png" alt="Redis_Install_Guide"></li>
<li>下载安装最新版的 gcc 编译器（c 语言的编译环境）</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">yum install centos-release-scl scl-utils-build
yum install -y devtoolset-8-toolchain
scl enable devtoolset-8 bash

yum install gcc-c++

gcc --version   # 测试 gcc版本，gcc -v<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li><p>解压安装文件：</p>
<pre class="line-numbers language-none"><code class="language-none"># 先将下载 redis-6.2.7.tar.gz 放置于 &#x2F;opt目录
1. cd &#x2F;opt  # 切换目录
2. tar -zxvf redis-6.2.7.tar.gz  # 解压安装包
3. cd redis-6.2.7  # 进入主目录<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>编译：make ；如果没有准备好C语言编译环境，make 会报错—Jemalloc/jemalloc.h：没有那个文件，可执行 make clean 清除后再次进行 make 编译</p>
</li>
<li><p>安装：make install ；会默认安装在 <strong>/usr/local/bin</strong> 目录下，存在如下文件：</p>
<blockquote>
<p>redis-benchmark：压力性能测试工具<br>redis-check-aof：修复有问题的AOF文件，rdb和aof后面讲<br>redis-check-dump：修复有问题的dump.rdb文件<br>redis-sentinel：Redis集群使用<br>redis-server：Redis服务器启动命令<br>redis-cli：客户端，操作入口</p>
</blockquote>
</li>
<li><p>启动：</p>
<ul>
<li>前台启动：redis-server，不推荐；redis-server –prot 6379 –requirepass ‘password’ –appendonly yes &gt;redis.log &amp;；关闭窗口即停止服务</li>
<li>后台启动：默认前台启动，需要配置文件参数，修改为后台启动： daemonize yes（general模块 128行），修改配置文件需要先备份默认生成的配置文件：将 /opt/redis-6.2.7/redis.conf 拷贝至 /usr/local/bin/myconf 下（需要先创建） ：cp /opt/redis-6.2.7/redis.conf /usr/local/bin/myconf<ol start="3">
<li>启动服务：主目录下运行（默认：/usr/local/bin）redis-server /myredis/redis.conf ；指定配置文件启动</li>
<li>连接使用：redis-cli -h ip -p 6379 ；默认没有密码，端口号为 6379</li>
<li>测试联通：ping ；返回 pong</li>
<li>读写测试：redis-benchmark</li>
<li>关闭连接：shutdown ；变成未连接状态</li>
<li>退出服务：exit</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="2-2-内容介绍"><a href="#2-2-内容介绍" class="headerlink" title="2.2 内容介绍"></a>2.2 内容介绍</h2><p><strong>redis-benchmark</strong>：安装自带的性能测试工具；使用 redis-benchmark 参数</p>
<pre class="line-numbers language-none"><code class="language-none">redis-benchmark -h localhost -p 6379 -c 100 -n 100000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>-h</strong></td>
<td align="left">指定服务器主机名</td>
<td align="left">127.0.0.1</td>
</tr>
<tr>
<td align="left"><strong>-p</strong></td>
<td align="left">指定服务器端口</td>
<td align="left">6379</td>
</tr>
<tr>
<td align="left"><strong>-s</strong></td>
<td align="left">指定服务器 socket</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>-c</strong></td>
<td align="left">指定并发连接数</td>
<td align="left">50</td>
</tr>
<tr>
<td align="left"><strong>-n</strong></td>
<td align="left">指定请求数</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="left"><strong>-d</strong></td>
<td align="left">以字节的形式指定 SET/GET 值的数据大小</td>
<td align="left">3</td>
</tr>
<tr>
<td align="left"><strong>-k</strong></td>
<td align="left">1=keep alive 0=reconnect</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>-r</strong></td>
<td align="left">SET/GET/INCR 使用随机 key，SADD 使用随机值</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>-P</strong></td>
<td align="left">通过管道传输 &lt;numreq&gt; 请求</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>-q</strong></td>
<td align="left">强制退出 redis；仅显示 query/sec 值</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>–csv</strong></td>
<td align="left">以 CSV 格式输出</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>-l（L 小写）</strong></td>
<td align="left">生成循环，永久执行测试</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>-t</strong></td>
<td align="left">仅运行以逗号分隔的测试命令列表</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>-I（i 大写）</strong></td>
<td align="left">Idle 模式；仅打开 N 个 idle 连接并等待</td>
<td align="left"></td>
</tr>
</tbody></table>
<h1 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h1><p><a target="_blank" rel="noopener" href="http://redisdoc.com/"><font face = "微软雅黑" color = 1E90FF size = 5>官网-命令参考文档</font></a>；<strong>命令不区分大小写</strong></p>
<h2 id="3-1-数据库"><a href="#3-1-数据库" class="headerlink" title="3.1 数据库"></a>3.1 数据库</h2><p><strong>数据库</strong>：默认16个数据库，初始默认使用0号库，所有库同样密码</p>
<pre class="line-numbers language-none"><code class="language-none">select dbid: 切换数据库，如：select 8
dbsize:      查看当前数据库的key的数量
flushdb:     清空当前库
flushall:    清空全部库
save:        立即保存数据
bgsave:      后台保存数据
auth password:登录，通过 config set requirepass &quot;xxx&quot; 设置密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-2-Key操作"><a href="#3-2-Key操作" class="headerlink" title="3.2 Key操作"></a>3.2 Key操作</h2><pre class="line-numbers language-none"><code class="language-none">keys *:            查看当前库所有key，查看指定库的所有键 keys *dbid，如 keys *1
exists k_name:     判断k_name是否存在
type k_name:       查看k_name的类型
move k_name db_num:移动数据到指定数据库
del k_name:        删除k_name对应的数据
unlink k_name:     删除k_name对应的数据；仅将k_name从keyspace元数据中删除，实际删除后续异步进行
expire k_name 10:  设置k_name的过期时间，默认单位为 s 秒
ttl k_name:        查看k_name的剩余有效时间；-1表示永不过期，-2表示已过期
type k_name:       查看k_name的数据类型<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-3-数据类型"><a href="#3-3-数据类型" class="headerlink" title="3.3 数据类型"></a>3.3 数据类型</h2><h3 id="3-3-1-字符串-String"><a href="#3-3-1-字符串-String" class="headerlink" title="3.3.1 字符串-String"></a>3.3.1 字符串-String</h3><p><strong>String</strong>：是 Redis 最基本的类型，一个 key 对应一个 value；二进制安全，可以包含任何数据，包括图片或序列化对象，value最多可以是 512M；底部数据结构为 <strong>简单动态字符串</strong>：SDS，Simple Dynamic String，可以修改的字符串，内部结构实现类似 Java 的 ArrayList，采用预分配冗余空间的方式来减少内存的频繁分配</p>
<p><strong>新建键值对</strong>：set k_name value [ex seconds|px millseconds|keeptll] [nx|xx]</p>
<ul>
<li>key，value：键值对的 key 和 value</li>
<li>ex seconds：k-v的超时秒数</li>
<li>px millseconds：k-v的超时毫秒数；与 ex互斥</li>
<li>nx：当数据库中key不存在时，将key-value添加数据库；如果 key值重复，则会覆盖之前的 value值</li>
<li>xx：当数据库中key存在时，将key-value添加数据库；与 nx互斥</li>
</ul>
<p><strong>获取键值对</strong>：</p>
<ul>
<li>获取指定键值对：get k_name，支持通配符 *</li>
<li>获取所有现有键：keys k_name，支持通配符 *</li>
</ul>
<p><strong>操作键值对</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">获取值长度：strlen k_name

新增键值对，并指定过期时间：setex k_name seconds value
新增键值对，不存在才会新建：setnx k_name value，只能设置 key 不存在的键值对，存在则不能新建，返回 0，表示新建失败
批量新增：mset k_name_1 value_1 k_name_2 value_2 ... ，一次性创建多个键值对，不同键值对用空格隔开
批量新增：msetnx k_name_1 value_1 k_name_2 value_2 ... ，一次性创建多个不存在的键值对
批量获取：mget k_name_1 k_name_2 ... ，一次性获取多个键值对的值

增加值：incr k_name，将 key 中储存的数字值增加1，只能对数字值操作；如果为空，新增值为1
增加指定值：incrby k_name step，将 key 中储存的数字值增加 step
减少值：decr k_name，将 key 中储存的数字值减少1，只能对数字值操作；如果为空，新增值为-1
增加指定值：decrby k_name step，将 key 中储存的数字值减少 step

追加修改值：append k_name value，将给定的 value 追加到原值的末尾；如果k_name不存在，则会新建
覆盖修改值：setrange k_name start_num value，从 start_num开始将 value覆盖写入 k_name对应值
取旧换新：getset k_name value，返回 k_name对应的旧值，并将对应值换成新的 value

获取指定长度：getrange k_name start_num stop_num，获取 k_name对应 value指定长度的内容，包含开始结束位置，索引从 0 开始，最后位置可以用 -1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>原子操作</strong>：不会被线程调度机制打断的操作，操作同时成功或同时失败；从开始一直到运行结束，中间不会有任何 context switch：切换到另一个线程；如：incr、decr等</p>
<ul>
<li><strong>单线程</strong>：能够在单条指令中完成的操作都认为是原子操作，因为中断只能发生于指令之间</li>
<li><strong>多线程</strong>：不能被其它进程或线程打断的操作就叫原子操作</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">批量新增：mset k_name_1 value_1 k_name_2 value_2 ... ，一次性创建多个键值对，不同键值对用空格隔开
批量新增：msetnx k_name_1 value_1 k_name_2 value_2 ... ，一次性创建多个不存在的键值对
批量获取：mget k_name_1 k_name_2 ... ，一次性获取多个键值对的值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-2-列表-List"><a href="#3-3-2-列表-List" class="headerlink" title="3.3.2 列表-List"></a>3.3.2 列表-List</h3><p><strong>List</strong>：单键多值的数据结构，是string类型的有序集合，按照插入顺序排序；可以添加一个元素到列表的 头部/左边 或者 尾部/右边；底部数据结构为 <strong>双向链表</strong>，对两端的操作性能很高，通过索引下标的操作中间的节点性能较差</p>
<p><strong>新增键值对</strong>：lpush/rpush 从 左边/右边 插入一个或多个值</p>
<ul>
<li><p>lpush k_name value_1 value_2 … ；存储顺序与插入顺序相反</p>
</li>
<li><p>rpush k_name value_1 value_2 … ；存储顺序与插入顺序相同</p>
</li>
</ul>
<p><strong>获取键值对</strong>：lrange k_name start stop：返回 k_name 指定范围内的数据；lrange k_name 0 -1，返回 k_name 里面的所有数据</p>
<p><strong>操作键值对</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">lpop k_name：从左边移除第一个值，并返回移除的数据
rpop k_name：从右边移除第一个值，并返回移除的数据
lrem k_name num value：将 k_name中值为 value的数据删除 num个(从左往右开始删除)

lindex k_name index_num：返回 k_name 在 index_name处(从左往右，从 0 开始)的值
llen k_name：获取 k_name 的长度，拥有值的数量

ltrim k_name start_idx stop_idx：截取 k_name中包含start_idx 到 stop_idx的值
rpoplpush k_name_1 k_name_2：从 k_name_1 右边取出一个值，插入 k_name_2 左边
lset k_name index_num value：将 k_name中 index_num位置处的值替换为 value
linsert k_name before&#x2F;after value ins_value：在 k_name的 value位置之前&#x2F;后插入ins_value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-3-集合-Set"><a href="#3-3-3-集合-Set" class="headerlink" title="3.3.3 集合-Set"></a>3.3.3 集合-Set</h3><p><strong>Set</strong>：功能与list类似，是string类型的无序集合，会自动进行去重操作；底层是一个 value为null的 hash表，所以添加，删除，查找的复杂度都是O(1)；底层数据结构为 <strong>dict字典</strong>，用哈希表实现</p>
<p><strong>新建键值对</strong>：sadd k_name value_1 value_2 … </p>
<p><strong>读取键值对</strong>：smembers k_name：取出 k_name的所有值</p>
<pre class="line-numbers language-none"><code class="language-none">srem k_name value：移除 k_name 中的 value
srem k_name value_1 value_2：删除 k_name中的 value_1 value_2
spop k_name：随机从 k_name 移除一个值，返回移除的值

smove k_name_1 k_name_2 value：将 k_name_1中的 value移动到 k_name_2

srandmember k_name num：随机从 k_name中读取 num个数据
sismember k_name value：判断 k_name中是否存在 value有1，没有0
scard k_name：返回 k_name中的元素个数

sinter k_name_1 k_name_2：取 k_name_1、k_name_2的交集(共有的元素)
sunion k_name_1 k_name_2：取 k_name_1、k_name_2的并集(所有的元素)
sdiff k_name_1 k_name_2：取 k_name_1、k_name_1的差集(k_name_1独有的元素)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-4-有序集合-Zset"><a href="#3-3-4-有序集合-Zset" class="headerlink" title="3.3.4 有序集合-Zset"></a>3.3.4 有序集合-Zset</h3><p><strong>Zset</strong>：sorted set，是一个没有重复元素的有序的字符串集合；按照每个元素的评分-score的高低顺序进行排序（由低到高）；集合的元素唯一，但评分可以重复</p>
<p><strong>新建键值对</strong>：zadd k_name score_1 value_1 score_2 value_2 … </p>
<p><strong>读取键值对</strong>：zrange k_name  start_num stop_num [withscores] ，按照 score由小到大的顺序取出 k_name的值，并显示 score</p>
<pre class="line-numbers language-none"><code class="language-none">zrem k_name value：删除 k_name的 value

zcard k_name：查看 k_name 的数据个数
zcount k_name min_num max_num：统计 k_name中 score在区间内的元素个数

zrangebyscore k_name min_num max_num [withscores] [limit offset count] ：读取 k_name的 score在 min_num~max_num 的元素；默认从小到大，-inf +inf：正负无穷
zrevrangebyscore k_name max_num min_num [withscores] ：按照从大到小排列
zrank k_name value：返回 k_name中的 value的排名，从 0 开始

zincrby k_name num value：将 k_name中 value的 score增加 num<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-5-哈希表-Hash"><a href="#3-3-5-哈希表-Hash" class="headerlink" title="3.3.5 哈希表-Hash"></a>3.3.5 哈希表-Hash</h3><p><strong>Hash</strong>：是一个键值对集合，是 string类型的 field 和 value 的映射；例：用户ID为查找的key，存储的 value用户对象包含姓名，年龄，生日等信息</p>
<p><img src="https://qizhongyi.gitee.io/images/Data/DataBase/Redis/Hash_KV.png" alt="Hash_KV"></p>
<p><strong>新建键值对</strong>：</p>
<ul>
<li>hset k_name f_name f_value ex n，新建一个键值对，在指定n秒之后失效</li>
<li>hmset k_name f_name_1 f_value_1 f_name_2 f_value_2 … ex n，新建一个多重键值对</li>
</ul>
<p><strong>获取键值对</strong>：</p>
<ul>
<li>hget k_name f_name；获取指定一个键的值</li>
<li>hmget k_name f_name_1 f_name_2 … ；获取指定多个键的值</li>
<li>hgetall k_name；获取所有的键和值</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">hsetnx k_name f_name value：将 hash集合指定不存在的 f_name设置为 value；如果存在，则设置失败

hdel k_name f_name：删除指定的字段，对应的值自动删除

hincrby k_name f_name value：将 hash集合指定 f_name增加 value
hdecrby k_name f_name value：将 hash集合指定 f_name减少 value

hlen k_name：获取 k_name中的数据个数（field的个数）
hkeys k_name：查看 hash集合的所有 field
hvals k_name：查看 hash集合的所有 value
hexists k_name f_name：判断哈希表 key中，给定 field域是否存在<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-6-地理信息-Geospatial"><a href="#3-3-6-地理信息-Geospatial" class="headerlink" title="3.3.6 地理信息-Geospatial"></a>3.3.6 地理信息-Geospatial</h3><p><strong>Geospatial</strong>：Geo-Geographic，地理信息；是元素的2维坐标，对应地图上的经纬度，提供经纬度设置，查询，范围查询，距离查询，经纬度Hash等常见操作；<strong>底层是 Zset 实现</strong></p>
<p><strong>新建键值对</strong>：geoadd k_name val_longitude val_latitude loc_name [ val_longitude_2 val_latitude_2 loc_name_2]；可同时加入多个，成功后返回成功插入的个数</p>
<p><strong>获取键值对</strong>：geopos k_name loc_name ；可同时获取多个</p>
<p><strong>操作键值对</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">geodist k_name name_1 name_2 [m&#x2F;km&#x2F;ft-英尺&#x2F;mi-英里] [WITHCOORD] [WITHDIST] [WITHHASH] [ASC|DESC]：计算直线距离，单位默认为 m米
- WITHDIST：在返回位置对象的同时，将位置对象与中心之间的距离也一并返回，距离的单位和用户给定的范围单位保持一致
- WITHCOORD：将位置对象的经度和维度也一并返回
- WITHHASH：以 52 位有符号整数的形式，返回位置对象经过原始 geohash 编码的有序集合分值；主要用于底层应用或者调试
- ASC|DESC：从近到远返回位置对象元素 | 从远到近返回位置对象元素

georadius k_name val_longitude val_latitude radius m&#x2F;km&#x2F;ft&#x2F;mi：获取给定经纬度在指定半径内的数据
geohash：返回一个或多个位置对象的 Geohash表示（11个字符）
georadiusbymember k_name loc_name radius m&#x2F;km&#x2F;ft&#x2F;mi：以给定的位置对象为中心，返回与其距离不超过给定最大距离的所有位置对象<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-7-位图-Bitmaps"><a href="#3-3-7-位图-Bitmaps" class="headerlink" title="3.3.7 位图-Bitmaps"></a>3.3.7 位图-Bitmaps</h3><p><strong>Bitmaps</strong>：本身不是一种数据类型，本身就是字符串：key-value，可以对字符串的位进行操作；合理地使用操作位能够有效地提高内存使用率和开发效率；可以把 Bitmaps想象成一个以位为单位的数组，数组的下标在Bitmaps中叫做 <strong>偏移量</strong></p>
<p><strong>新增Bitmaps键值对</strong>：<strong>setbit k_name offset value</strong> ；假设现在有20个用户，userid=1， 6， 11， 15， 19 的用户访问了网站， 那么当前 Bitmaps初始化结果如下图：</p>
<p><img src="https://qizhongyi.gitee.io/images/Data/DataBase/Redis/Bitmaps_init.png" alt="Bitmaps_init"></p>
<p>对应初始化语句为：分别对每一个偏移量进行设置</p>
<pre class="line-numbers language-none"><code class="language-none">setbit user_id_0001 1 1
setbit user_id_0001 6 1
setbit user_id_0001 11 1
setbit user_id_0001 15 1
setbit user_id_0001 19 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>读取Bitmaps键值对</strong>：<strong>get k_name:k_value offset</strong></p>
<pre class="line-numbers language-none"><code class="language-none">getbit user_id_0001 1  # 返回 1， 1,6,11,15,19，返回值都为1，其余为0
getbit user_id_0001 2  # 返回 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">bircount k_name [start end]：统计字符串指定范围内被设置为1的 bit数量

bitop and&#x2F;or&#x2F;not&#x2F;xor unique:new_k_name unique:old_k_name_1 unique:old_k_name_2 ；返回 old_k_name_1、old_k_name_2相同偏移量处修改的数量；and-交集、or-并集、not-非、xor-异或
例：bitop and unique:user_0001_2 unique:user_id_0001 user_id_0002：两天都访问过的用户数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>set和Bitmaps存储一天活跃用户对比</strong>：假设网站有1亿用户， 每天独立访问的用户有5千万</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>每个用户id占用空间</th>
<th>需要存储的用户量</th>
<th>全部内存量</th>
</tr>
</thead>
<tbody><tr>
<td>set</td>
<td>64位</td>
<td>50000000</td>
<td>64位*50000000 = 400MB</td>
</tr>
<tr>
<td>Bitmaps</td>
<td>1位</td>
<td>100000000</td>
<td>1位*100000000 = 12.5MB</td>
</tr>
</tbody></table>
<p><strong>set和Bitmaps存储独立用户空间对比</strong>：假设网站有1亿用户， 每天独立访问的用户有5千万</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>一天</th>
<th>一个月</th>
<th>一年</th>
</tr>
</thead>
<tbody><tr>
<td>set</td>
<td>400MB</td>
<td>12GB</td>
<td>144GB</td>
</tr>
<tr>
<td>Bitmaps</td>
<td>12.5MB</td>
<td>375MB</td>
<td>4.5GB</td>
</tr>
</tbody></table>
<p><strong>set和Bitmaps存储一天活跃用户对比</strong>：独立用户比较少</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>每个用户id占用空间</th>
<th>需要存储的用户量</th>
<th>全部内存量</th>
</tr>
</thead>
<tbody><tr>
<td>set</td>
<td>64位</td>
<td>100000</td>
<td>64位*100000 = 800KB</td>
</tr>
<tr>
<td>Bitmaps</td>
<td>1位</td>
<td>100000000</td>
<td>1位*100000000 = 12.5MB</td>
</tr>
</tbody></table>
<h3 id="3-3-8-基数-Hyperloglog"><a href="#3-3-8-基数-Hyperloglog" class="headerlink" title="3.3.8 基数-Hyperloglog"></a>3.3.8 基数-Hyperloglog</h3><p><strong>基数</strong>：集合中不重复元素个数称为基数</p>
<p><strong>Hyperloglog</strong>：是用来做基数统计的算法，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定且很小；每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基数， <strong>Hyperloglog 只会根据输入元素来计算基数，不会储存输入元素本身</strong></p>
<p><strong>新建Hyperloglog键值对</strong>：pfadd k_name value_1 value_2 …</p>
<p><strong>操作Hyperloglog键值对</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">pfcount k_name ：返回基数
pfmerge new_k_name old_k_name_1 old_k_name_2 ：将多个集合合并到一个新集合中<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="3-4-发布订阅"><a href="#3-4-发布订阅" class="headerlink" title="3.4 发布订阅"></a>3.4 发布订阅</h2><p><strong>发布订阅</strong>：发布订阅 (pub/sub) 是 Redis的一种消息通信模式：发送者 (pub) 发送消息，订阅者 (sub) 接收消息，Redis 客户端可以订阅任意数量的频道</p>
<pre class="line-numbers language-none"><code class="language-none">1. 打开一个客户端订阅 channel1：subscribe channel_name；
2. 打开另一个客户端，给channel1发布消息hello：publish channel_name hello
3. 打开第一个客户端可以看到发送的消息

注：发布的消息没有持久化<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="4-新特性"><a href="#4-新特性" class="headerlink" title="4. 新特性"></a>4. 新特性</h1><h2 id="4-1-ACL"><a href="#4-1-ACL" class="headerlink" title="4.1 ACL"></a>4.1 ACL</h2><p><strong>ACL</strong>：Access Control List，访问控制列表；允许根据可以执行的命令和可以访问的键来限制连接；可进行更细粒度的权限控制 ：（1）接入权限：用户名和密码；（2）可以执行的命令；（3）可以操作的 KEY</p>
<pre class="line-numbers language-none"><code class="language-none">acl list：展现用户权限列表
acl whoami：命令查看当前用户
acl cat：查看添加权限指令类别；acl cat string：可以查看类型下具体命令<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>类型</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>启动用户</td>
<td>on</td>
<td>激活某用户账号</td>
</tr>
<tr>
<td>禁用用户</td>
<td>off</td>
<td>禁用某用户账号（已验证的连接仍然可以工作）；如果默认用户被标记为off，则新连接将在未进行身份验证的情况下启动，并要求用户使用AUTH选项发送AUTH或HELLO，以便以某种方式进行身份验证</td>
</tr>
<tr>
<td>权限添加</td>
<td>+&lt;command&gt;</td>
<td>将指令添加到用户可以调用的指令列表中</td>
</tr>
<tr>
<td>权限删除</td>
<td>-&lt;command&gt;</td>
<td>从用户可执行指令列表移除指令</td>
</tr>
<tr>
<td></td>
<td>+@&lt;category&gt;</td>
<td>添加该类别中用户要调用的所有指令，有效类别为@admin、@set、@sortedset…等，通过调用ACL CAT命令查看完整列表；特殊类别@all表示所有命令，包括当前存在于服务器中的命令，以及将来将通过模块加载的命令</td>
</tr>
<tr>
<td></td>
<td>-@&lt;actegory&gt;</td>
<td>从用户可调用指令中移除类别</td>
</tr>
<tr>
<td></td>
<td>allcommands</td>
<td>+@all的别名</td>
</tr>
<tr>
<td></td>
<td>nocommand</td>
<td>-@all的别名</td>
</tr>
<tr>
<td>可操作键的添加或删除</td>
<td>~&lt;pattern&gt;</td>
<td>添加可作为用户可操作的键的模式；如~*允许所有的键</td>
</tr>
</tbody></table>
<h2 id="4-2-IO多线程"><a href="#4-2-IO多线程" class="headerlink" title="4.2 IO多线程"></a>4.2 IO多线程</h2><p><strong>IO多线程</strong>：指客户端交互部分的网络IO交互处理模块多线程，而非执行命令多线程；多线程部分只是用来处理网络数据的读写和协议解析，Redis执行命令依然是单线程</p>
<h2 id="4-3-其他"><a href="#4-3-其他" class="headerlink" title="4.3 其他"></a>4.3 其他</h2><ul>
<li>支持 Cluster</li>
<li>RESP3新的 Redis 通信协议：优化服务端与客户端之间通信</li>
<li>Client side caching客户端缓存：基于 RESP3 协议实现的客户端缓存功能</li>
<li>Proxy集群代理模式：让 Cluster 拥有像单实例一样的接入方式，降低使用cluster的门槛</li>
<li>Modules API</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">戚中一</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://qizhongyi.gitee.io/202105/2163107.html">https://qizhongyi.gitee.io/202105/2163107.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">戚中一</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">
                                    <span class="chip bg-color">数据库</span>
                                </a>
                            
                                <a href="/tags/NoSQL/">
                                    <span class="chip bg-color">NoSQL</span>
                                </a>
                            
                                <a href="/tags/Redis/">
                                    <span class="chip bg-color">Redis</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">熬夜撸码，来杯咖啡！</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/202105/2221246.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="数据仓库-基础">
                        
                        <span class="card-title">数据仓库-基础</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            写在前面：本文主要记录 数据仓库使用 的相关基础知识
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-05-22
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%9F%BA%E7%A1%80/" class="post-category">
                                    基础
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">
                        <span class="chip bg-color">数据仓库</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/202105/2017570.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="PostgreSQL基础-指令">
                        
                        <span class="card-title">PostgreSQL基础-指令</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            写在前面：本文主要记录PostgreSQL的基础知识-常用
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-05-20
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/" class="post-category">
                                    常见操作指令
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">
                        <span class="chip bg-color">数据库</span>
                    </a>
                    
                    <a href="/tags/PostgreSQL/">
                        <span class="chip bg-color">PostgreSQL</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 戚中一<br />'
            + '文章作者: 戚中一<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('10'),
            headingSelector: 'h1, h2, h3, h4, h5'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2022</span>
            
            <a href="/about" target="_blank">戚中一</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">273.5k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/qizhongyizhang" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:18371879651@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
